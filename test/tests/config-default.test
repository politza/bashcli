#!/usr/bin/env bash

PATH=${PWD}/fixtures/config-default:${PATH}
output=$(mktemp)
TEST_BASHCLI_GLOBAL_DIR=$(mktemp -d)
TEST_BASHCLI_GLOBAL_CONFIG=${TEST_BASHCLI_GLOBAL_DIR}/config/cli.conf

trap "rm -r -- '${output}' '${TEST_BASHCLI_GLOBAL_DIR}'" EXIT

before-each() {
  export BASHCLI_GLOBAL_DIR=${TEST_BASHCLI_GLOBAL_DIR}

  mkdir --parents "${TEST_BASHCLI_GLOBAL_CONFIG%/*}"
  
  cat > "${TEST_BASHCLI_GLOBAL_CONFIG}" <<EOF
global-property=global-value
EOF
}

test-config-get-global-value() {
  cli config get global-property &> "${output}"
  diff "${output}" - <<<global-value
}

test-config-get-default-value() {
  cli config get default-property &> "${output}"
  diff "${output}" - <<<default-value
}

test-config-get-default-profile-value() {
  cli config get global-property --profile=profile &> "${output}"
  diff "${output}" - <<<default-profile-value
}

. ./lib/run-tests
